<!DOCTYPE html><html lang="en">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>Performance - Logtalk</title>

<meta name="description" content="Logtalk - Declarative object-oriented logic programming language
">
<link rel="canonical" href="http://localhost:4000/performance.html"><link rel="alternate" type="application/rss+xml" title="Logtalk" href="/feed.xml">
<!-- begin favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#355b95">
<meta name="theme-color" content="#ffffff">
<!-- end favicon --><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" >
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.decodeUrl = function(str) {
    return str ? decodeURIComponent(str.replace(/\+/g, '%20')) : '';
  };


  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i, cb; loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cb = cbs[i]; cb();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.3',
      sources: {
        font_awesome: 'https://use.fontawesome.com/releases/v5.0.13/css/all.css',
        jquery: 'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js',
        leancloud_js_sdk: '//cdn1.lncld.net/static/js/3.4.1/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script></head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main page__viewport has-aside cell cell--auto">

      <div class="page__main-inner">
        <div></div><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand">
          <strong>[ ⊨ ]&nbsp;</strong><a title="Logtalk - Declarative object-oriented logic programming language
" href="/">Logtalk</a></div>
<!--
        <button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button>
-->
      </div><nav class="navigation">
        <ul><li class="navigation__link"><a href="/rationale.html">Rationale</a></li><li class="navigation__link"><a href="/features.html">Features</a></li><li class="navigation__link"><a href="/documentation.html">Documentation</a></li><li class="navigation__link"><a href="/download.html">Download</a></li><li class="navigation__link"><a href="/tools.html">Tools</a></li><li class="navigation__link"><a href="/guides.html">Guides</a></li><li class="navigation__link"><a href="/support.html">Support</a></li><li class="navigation__link"><a href="/related.html">Related</a></li><li class="navigation__link"><a href="/news.html">News</a></li><li class="navigation__link"><a href="/blog.html">Blog</a></li><li class="navigation__link"><a href="/search.html"><i class="fa fa-search" aria-hidden="true"></i></a></li><!--
          <li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li>
-->
        </ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div></aside></div>

              <div class="col-main cell cell--auto"><article itemscope itemtype="http://schema.org/Article"><div class="article__header"><header><h1>Performance</h1></header></div><meta itemprop="headline" content="Performance"><meta itemprop="author" content="Paulo Moura"/><div class="js-article-content"><div class="layout--article">

  <div class="article__content" itemprop="articleBody"><p>This page contains benchmark results for selected Prolog backends. The main
goal of this page it to give you some data for comparing predicate
performance in plain Prolog and using Logtalk objects. Benchmark results
are provided for both static code and dynamic code.</p>

<p>All results are given in number of calls per second. By default, the
benchmark code repeats each goal up to 100000 times in order to get more
accurate results. The exception is SICStus Prolog where a value of 1000000
was used for more accurate results.</p>

<p>Benchmarks run on an Apple iMac 3.8 GHz 8-Core Intel Core i7, 32GB RAM, macOS 14.7.1.</p>

<h2 id="benchmark-goals">Benchmark goals</h2>

<p>All the tests have been performed using the <code class="highlighter-rouge">benchmarks</code> example
distributed with Logtalk 3.85.0, using static binding with optional
features (including events support) disabled. This provides the most
relevant scenario for comparing Logtalk performance with plain Prolog
performance. The <code class="highlighter-rouge">benchmarks</code> example contains loader files for easily
setting up this and other test scenarios (e.g. dynamic binding).</p>

<h2 id="static-code-test-goals">Static code test goals</h2>

<p>The <code class="highlighter-rouge">benchmarks</code> example provides list length and naive list reverse
predicates defined in plain Prolog, in a Prolog module, and in a Logtalk
object (predicate definitions are the same in all cases). The following
goals are used for the first two benchmark tests:</p>

<blockquote>
  <p>s11: <code class="highlighter-rouge">generate_list(30, List), my_length(List, _)</code></p>

  <p>s12: <code class="highlighter-rouge">generate_list(30, List), module:mod_length(List, _)</code></p>

  <p>s13: <code class="highlighter-rouge">generate_list(30, List), object::length(List, _)</code></p>

  <p>s21: <code class="highlighter-rouge">generate_list(30, List), my_nrev(List, _)</code></p>

  <p>s22: <code class="highlighter-rouge">generate_list(30, List), module:mod_nrev(List, _)</code></p>

  <p>s23: <code class="highlighter-rouge">generate_list(30, List), object::nrev(List, _)</code></p>
</blockquote>

<p>These benchmark tests use a list of 30 elements as an argument to the
list predicates. Increasing the list length may lead to decreasing
performance differences between plain Prolog and Logtalk as the list
length computation time starts to outweigh the overhead of the message
sending mechanism. Likewise, decreasing the list length may lead to
increasing performance differences between plain Prolog and Logtalk (up
to the point you will be closing on the Logtalk message sending
mechanism overhead when compared to plain Prolog predicate calls).
However, these tests make use of common library predicates where static
binding is easily enabled, eliminating the message sending mechanism
overheads. The next two examples deal with graph search:</p>

<blockquote>
  <p>s31: <code class="highlighter-rouge">maze_solve(1, 7, _)</code></p>

  <p>s32: <code class="highlighter-rouge">module:mod_maze_solve(1, 7, _)</code></p>

  <p>s33: <code class="highlighter-rouge">maze::solve(1, 7, _)</code></p>

  <p>s41: <code class="highlighter-rouge">graph_path(0, 4, _)</code></p>

  <p>s42: <code class="highlighter-rouge">module:mod_graph_path(0, 4, _)</code></p>

  <p>s43: <code class="highlighter-rouge">graph::path(0, 4, _)</code></p>
</blockquote>

<p>When static binding is used, the performance of each set of goals is
expected to be similar. The performance of Logtalk can be worse due to
the overhead of the extra argument added to each compiled object
predicate for carrying execution context information. This overhead
depends on the Prolog abstract machine and on the optimizations used to
pass unchanged arguments between predicate calls.</p>

<h2 id="category-test-goals">Category test goals</h2>

<p>Category predicates can be called using either the <code class="highlighter-rouge">::/1</code> or the <code class="highlighter-rouge">^^/1</code>
control constructs. When using the <code class="highlighter-rouge">^^/1</code> control construct, the lookup
for both the predicate declaration and the predicate definition begins
in <em>this</em> and is restricted to the imported categories. Depending on how
the category is compiled, Logtalk may use static binding for <code class="highlighter-rouge">^^/1</code>
calls, providing the same performance level as calls to local object
predicates. The following goals are used for the benchmark tests:</p>

<blockquote>
  <p>c1: <code class="highlighter-rouge">leaf::obj_local</code></p>

  <p>c2: <code class="highlighter-rouge">leaf::ctg_direct</code></p>

  <p>c3: <code class="highlighter-rouge">leaf::ctg_self</code></p>
</blockquote>

<p>The <code class="highlighter-rouge">obj_local</code> method calls a local object predicate; the performance
of such calls is equal or close to plain Prolog. The <code class="highlighter-rouge">ctg_direct</code> method
uses the <code class="highlighter-rouge">^^/1</code> control construct to call an imported category predicate.
The <code class="highlighter-rouge">ctg_self</code> method uses the <code class="highlighter-rouge">::/1</code> message sending control construct
to call an imported category predicate. While the <code class="highlighter-rouge">^^/1</code> calls may use
static binding, the <code class="highlighter-rouge">::/1</code> calls always use dynamic binding and a lookup
caching mechanism. Note that the choice between either control construct
is not simply a question of performance as the control constructs
provide different semantics for calling imported category predicates.
All three predicates perform the same computation (generating a list of
twenty elements and calculating its length) using local predicates.</p>

<h2 id="dynamic-code-test-goals">Dynamic code test goals</h2>

<p>Dynamic code tests include both object database updates and creating and
abolishing dynamic objects. The <code class="highlighter-rouge">benchmarks</code> example provides an object
named <code class="highlighter-rouge">database</code>, which defines a set of predicates for testing the
Logtalk built-in database methods as described below. The following
goals are used for the benchmark tests:</p>

<blockquote>
  <p>d1: <code class="highlighter-rouge">create_object(xpto, [], [], []), abolish_object(xpto)</code></p>

  <p>d2: <code class="highlighter-rouge">plain_dyndb(_)</code></p>

  <p>d3: <code class="highlighter-rouge">database::this_dyndb(_)</code></p>

  <p>d4: <code class="highlighter-rouge">database::self_dyndb(_)</code></p>

  <p>d5: <code class="highlighter-rouge">database::obj_dyndb(_)</code></p>
</blockquote>

<p>The first test simply creates and abolishes a (dynamic) object. The
remaining tests are used for benchmarking object database updates,
comparing with plain Prolog database updates. The <code class="highlighter-rouge">*_dyndb</code> tests simply
assert (using <code class="highlighter-rouge">assertz/1</code>) and retract a clause (using <code class="highlighter-rouge">retract/1</code>) of a
dynamic predicate with arity one. The <code class="highlighter-rouge">plain_dyndb(_)</code> test uses the
Prolog built-in database predicates. The other three tests use the
Logtalk built-in database methods, using a direct method call
(<code class="highlighter-rouge">this_dyndb(_)</code>), a call using <code class="highlighter-rouge">::/1</code> (<code class="highlighter-rouge">self_dyndb(_)</code>), and a call
using <code class="highlighter-rouge">::/2</code> (<code class="highlighter-rouge">obj_dyndb(_)</code>).</p>

<h2 id="static-code-benchmark-results">Static code benchmark results</h2>

<p>The last columns show the trade-off between plain Prolog and Logtalk.
Dynamic binding is never used in the Prolog module tests.</p>

<h2 id="static-binding-no-events-support">Static binding (no events support)</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Prolog compiler</th>
      <th style="text-align: right">     s11     </th>
      <th style="text-align: right">     s12     </th>
      <th style="text-align: right">     s13     </th>
      <th style="text-align: right">   s13/s11   </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CxProlog 0.98.3</td>
      <td style="text-align: right">475163</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">415265</td>
      <td style="text-align: right">87.4 %</td>
    </tr>
    <tr>
      <td style="text-align: left">ECLiPSe 7.0#57</td>
      <td style="text-align: right">2542284</td>
      <td style="text-align: right">1695466</td>
      <td style="text-align: right">2460666</td>
      <td style="text-align: right">96.8 %</td>
    </tr>
    <tr>
      <td style="text-align: left">GNU Prolog 1.6.0</td>
      <td style="text-align: right">3571429</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">3333333</td>
      <td style="text-align: right">93.3 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SICStus Prolog 4.9.0</td>
      <td style="text-align: right">27027027</td>
      <td style="text-align: right">25641026</td>
      <td style="text-align: right">27027027</td>
      <td style="text-align: right">100.0 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SWI-Prolog 9.3.14</td>
      <td style="text-align: right">1586999</td>
      <td style="text-align: right">1559722</td>
      <td style="text-align: right">1562695</td>
      <td style="text-align: right">98.5 %</td>
    </tr>
    <tr>
      <td style="text-align: left">Trealla Prolog 2.60.0</td>
      <td style="text-align: right">131166</td>
      <td style="text-align: right">124374</td>
      <td style="text-align: right">120015</td>
      <td style="text-align: right">91.5 %</td>
    </tr>
    <tr>
      <td style="text-align: left">XSB 5.0.0</td>
      <td style="text-align: right">3125000</td>
      <td style="text-align: right">3030303</td>
      <td style="text-align: right">2941176</td>
      <td style="text-align: right">94.1 %</td>
    </tr>
    <tr>
      <td style="text-align: left">YAP 7.6.0</td>
      <td style="text-align: right">1785714</td>
      <td style="text-align: right">1724138</td>
      <td style="text-align: right">1754386</td>
      <td style="text-align: right">98.2 %</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Prolog compiler</th>
      <th style="text-align: right">     s21     </th>
      <th style="text-align: right">     s22     </th>
      <th style="text-align: right">     s23     </th>
      <th style="text-align: right">   s23/s21   </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CxProlog 0.98.3</td>
      <td style="text-align: right">89545</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">85407</td>
      <td style="text-align: right">95.4 %</td>
    </tr>
    <tr>
      <td style="text-align: left">ECLiPSe 7.0#57</td>
      <td style="text-align: right">135901</td>
      <td style="text-align: right">122859</td>
      <td style="text-align: right">120678</td>
      <td style="text-align: right">88.8 %</td>
    </tr>
    <tr>
      <td style="text-align: left">GNU Prolog 1.6.0</td>
      <td style="text-align: right">187617</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">198413</td>
      <td style="text-align: right">105.8 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SICStus Prolog 4.9.0</td>
      <td style="text-align: right">766284</td>
      <td style="text-align: right">732601</td>
      <td style="text-align: right">768049</td>
      <td style="text-align: right">100.2 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SWI-Prolog 9.3.14</td>
      <td style="text-align: right">84190</td>
      <td style="text-align: right">83572</td>
      <td style="text-align: right">82314</td>
      <td style="text-align: right">97.8 %</td>
    </tr>
    <tr>
      <td style="text-align: left">Trealla Prolog 2.60.0</td>
      <td style="text-align: right">11473</td>
      <td style="text-align: right">11328</td>
      <td style="text-align: right">10520</td>
      <td style="text-align: right">91.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">XSB 5.0.0</td>
      <td style="text-align: right">176991</td>
      <td style="text-align: right">176367</td>
      <td style="text-align: right">171527</td>
      <td style="text-align: right">96.9 %</td>
    </tr>
    <tr>
      <td style="text-align: left">YAP 7.6.0</td>
      <td style="text-align: right">97371</td>
      <td style="text-align: right">96339</td>
      <td style="text-align: right">95785</td>
      <td style="text-align: right">98.4 %</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Prolog compiler</th>
      <th style="text-align: right">     s31     </th>
      <th style="text-align: right">     s32     </th>
      <th style="text-align: right">     s33     </th>
      <th style="text-align: right">   s33/s31   </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CxProlog 0.98.3</td>
      <td style="text-align: right">150145</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">141462</td>
      <td style="text-align: right">94.2 %</td>
    </tr>
    <tr>
      <td style="text-align: left">ECLiPSe 7.0#57</td>
      <td style="text-align: right">436687</td>
      <td style="text-align: right">403474</td>
      <td style="text-align: right">407477</td>
      <td style="text-align: right">93.3 %</td>
    </tr>
    <tr>
      <td style="text-align: left">GNU Prolog 1.6.0</td>
      <td style="text-align: right">213675</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">204082</td>
      <td style="text-align: right">95.5 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SICStus Prolog 4.9.0</td>
      <td style="text-align: right">1414427</td>
      <td style="text-align: right">1342282</td>
      <td style="text-align: right">1335113</td>
      <td style="text-align: right">94.4 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SWI-Prolog 9.3.14</td>
      <td style="text-align: right">205188</td>
      <td style="text-align: right">205070</td>
      <td style="text-align: right">200929</td>
      <td style="text-align: right">97.9 %</td>
    </tr>
    <tr>
      <td style="text-align: left">Trealla Prolog 2.60.0</td>
      <td style="text-align: right">59145</td>
      <td style="text-align: right">58214</td>
      <td style="text-align: right">52192</td>
      <td style="text-align: right">88.2 %</td>
    </tr>
    <tr>
      <td style="text-align: left">XSB 5.0.0</td>
      <td style="text-align: right">359712</td>
      <td style="text-align: right">359712</td>
      <td style="text-align: right">346021</td>
      <td style="text-align: right">96.2 %</td>
    </tr>
    <tr>
      <td style="text-align: left">YAP 7.6.0</td>
      <td style="text-align: right">273224</td>
      <td style="text-align: right">276243</td>
      <td style="text-align: right">255754</td>
      <td style="text-align: right">93.6 %</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Prolog compiler</th>
      <th style="text-align: right">     s41     </th>
      <th style="text-align: right">     s42     </th>
      <th style="text-align: right">     s43     </th>
      <th style="text-align: right">   s43/s41   </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CxProlog 0.98.3</td>
      <td style="text-align: right">48027</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">36524</td>
      <td style="text-align: right">76.0 %</td>
    </tr>
    <tr>
      <td style="text-align: left">ECLiPSe 7.0#57</td>
      <td style="text-align: right">89284</td>
      <td style="text-align: right">79597</td>
      <td style="text-align: right">84087</td>
      <td style="text-align: right">94.2 %</td>
    </tr>
    <tr>
      <td style="text-align: left">GNU Prolog 1.6.0</td>
      <td style="text-align: right">55432</td>
      <td style="text-align: right">-</td>
      <td style="text-align: right">52521</td>
      <td style="text-align: right">94.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SICStus Prolog 4.9.0</td>
      <td style="text-align: right">352113</td>
      <td style="text-align: right">345185</td>
      <td style="text-align: right">354359</td>
      <td style="text-align: right">100.6 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SWI-Prolog 9.3.14</td>
      <td style="text-align: right">48796</td>
      <td style="text-align: right">40805</td>
      <td style="text-align: right">47235</td>
      <td style="text-align: right">96.8 %</td>
    </tr>
    <tr>
      <td style="text-align: left">Trealla Prolog 2.60.0</td>
      <td style="text-align: right">14647</td>
      <td style="text-align: right">14310</td>
      <td style="text-align: right">12764</td>
      <td style="text-align: right">87.1 %</td>
    </tr>
    <tr>
      <td style="text-align: left">XSB 5.0.0</td>
      <td style="text-align: right">97087</td>
      <td style="text-align: right">97087</td>
      <td style="text-align: right">92937</td>
      <td style="text-align: right">95.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">YAP 7.6.0</td>
      <td style="text-align: right">59737</td>
      <td style="text-align: right">59737</td>
      <td style="text-align: right">57571</td>
      <td style="text-align: right">96.4 %</td>
    </tr>
  </tbody>
</table>

<h2 id="category-benchmark-results">Category benchmark results</h2>

<p>The last column shows the trade-off between static binding (<code class="highlighter-rouge">c2</code>) and
dynamic binding (<code class="highlighter-rouge">c3</code>) when calling category predicates.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Prolog compiler</th>
      <th style="text-align: right">     c1     </th>
      <th style="text-align: right">     c2     </th>
      <th style="text-align: right">     c3     </th>
      <th style="text-align: right">   c3/c2   </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CxProlog 0.98.3</td>
      <td style="text-align: right">227929</td>
      <td style="text-align: right">226007</td>
      <td style="text-align: right">216390</td>
      <td style="text-align: right">95.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">ECLiPSe 7.0#57</td>
      <td style="text-align: right">843955</td>
      <td style="text-align: right">825235</td>
      <td style="text-align: right">581380</td>
      <td style="text-align: right">70.4 %</td>
    </tr>
    <tr>
      <td style="text-align: left">GNU Prolog 1.6.0</td>
      <td style="text-align: right">1449275</td>
      <td style="text-align: right">1449275</td>
      <td style="text-align: right">952381</td>
      <td style="text-align: right">65.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SICStus Prolog 4.9.0</td>
      <td style="text-align: right">4524887</td>
      <td style="text-align: right">4545455</td>
      <td style="text-align: right">2604167</td>
      <td style="text-align: right">57.3 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SWI-Prolog 9.3.14</td>
      <td style="text-align: right">496887</td>
      <td style="text-align: right">491072</td>
      <td style="text-align: right">460547</td>
      <td style="text-align: right">93.8 %</td>
    </tr>
    <tr>
      <td style="text-align: left">Trealla Prolog 2.60.0</td>
      <td style="text-align: right">90936</td>
      <td style="text-align: right">90222</td>
      <td style="text-align: right">74027</td>
      <td style="text-align: right">82.0 %</td>
    </tr>
    <tr>
      <td style="text-align: left">XSB 5.0.0</td>
      <td style="text-align: right">1098901</td>
      <td style="text-align: right">1075269</td>
      <td style="text-align: right">943396</td>
      <td style="text-align: right">87.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">YAP 7.6.0</td>
      <td style="text-align: right">617284</td>
      <td style="text-align: right">598802</td>
      <td style="text-align: right">558659</td>
      <td style="text-align: right">93.3 %</td>
    </tr>
  </tbody>
</table>

<h2 id="dynamic-code-benchmark-results">Dynamic code benchmark results</h2>

<p>The last column shows the trade-off between plain
Prolog (<code class="highlighter-rouge">d2</code>) and Logtalk using static binding (<code class="highlighter-rouge">d3</code>).</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Prolog compiler</th>
      <th style="text-align: right">     d1     </th>
      <th style="text-align: right">     d2     </th>
      <th style="text-align: right">     d3     </th>
      <th style="text-align: right">     d4     </th>
      <th style="text-align: right">     d5     </th>
      <th style="text-align: right">   d3/d2   </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CxProlog 0.98.3</td>
      <td style="text-align: right">126</td>
      <td style="text-align: right">143847</td>
      <td style="text-align: right">135044</td>
      <td style="text-align: right">118913</td>
      <td style="text-align: right">122753</td>
      <td style="text-align: right">93.9 %</td>
    </tr>
    <tr>
      <td style="text-align: left">ECLiPSe 7.0#57</td>
      <td style="text-align: right">6868</td>
      <td style="text-align: right">970814</td>
      <td style="text-align: right">933650</td>
      <td style="text-align: right">497683</td>
      <td style="text-align: right">941957</td>
      <td style="text-align: right">96.2 %</td>
    </tr>
    <tr>
      <td style="text-align: left">GNU Prolog 1.6.0</td>
      <td style="text-align: right">18501</td>
      <td style="text-align: right">2325581</td>
      <td style="text-align: right">2222222</td>
      <td style="text-align: right">854701</td>
      <td style="text-align: right">2127660</td>
      <td style="text-align: right">95.6 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SICStus Prolog 4.9.0</td>
      <td style="text-align: right">17269</td>
      <td style="text-align: right">2967359</td>
      <td style="text-align: right">2314815</td>
      <td style="text-align: right">1623377</td>
      <td style="text-align: right">2762431</td>
      <td style="text-align: right">78.0 %</td>
    </tr>
    <tr>
      <td style="text-align: left">SWI-Prolog 9.3.14</td>
      <td style="text-align: right">7547</td>
      <td style="text-align: right">726475</td>
      <td style="text-align: right">678440</td>
      <td style="text-align: right">528259</td>
      <td style="text-align: right">686629</td>
      <td style="text-align: right">93.4 %</td>
    </tr>
    <tr>
      <td style="text-align: left">Trealla Prolog 2.60.0</td>
      <td style="text-align: right">2880</td>
      <td style="text-align: right">332515</td>
      <td style="text-align: right">298230</td>
      <td style="text-align: right">205476</td>
      <td style="text-align: right">290353</td>
      <td style="text-align: right">89.7 %</td>
    </tr>
    <tr>
      <td style="text-align: left">XSB 5.0.0</td>
      <td style="text-align: right">2535</td>
      <td style="text-align: right">318471</td>
      <td style="text-align: right">316456</td>
      <td style="text-align: right">284091</td>
      <td style="text-align: right">330033</td>
      <td style="text-align: right">99.4 %</td>
    </tr>
    <tr>
      <td style="text-align: left">YAP 7.6.0</td>
      <td style="text-align: right">2297</td>
      <td style="text-align: right">145560</td>
      <td style="text-align: right">148810</td>
      <td style="text-align: right">131062</td>
      <td style="text-align: right">148588</td>
      <td style="text-align: right">102.2 %</td>
    </tr>
  </tbody>
</table>

<h2 id="remarks">Remarks</h2>

<ul>
  <li>It's surprisingly difficult to get stable results, specially with
some Prolog compilers. One the reasons seems to be the
operating-system constant shuffling of processes between the cores.</li>
  <li>Some results are odd, either above the expected maximum (100% of
plain Prolog performance) or lower than what's reasonable to
expect. This happens mostly on the most simple benchmark goals.
Benchmarks where a more significant amount of work is performed seem
to be more (but not complete) immune to these issues.</li>
  <li>All benchmark tests use the default memory allocation for the
different program areas. Changing the size of these program areas
can have a big impact on the benchmark results (e.g. increasing
stack size to avoid wasting time expanding the stack or doing
garbage collection).</li>
  <li>Logtalk usually performs better with Prolog compilers with mature
virtual machines when compared with Prolog compilers with younger
and less optimized virtual machines. The presence, in Logtalk
compiled code, of a hidden execution context predicate argument is a
particular sensitive point in virtual machines optimization as this
extra argument is usually passed unchanged between local predicate
calls.</li>
  <li><strong>These are too few and too limited benchmark tests to effectively
compare Prolog compiler performance.</strong> Notably, some of the Prolog
versions used are development versions due to the latest stable
version being either too old or containing critical bugs.</li>
  <li>Processor caches sometimes result in tests one order of magnitude
better than the results posted above.</li>
  <li>Some of the Prolog built-in predicates used for measuring CPU time
are not as accurate as we would like. Despite each benchmark goal
being proved by default 100000 times, repeating the tests always
show some variation on the final results. Increasing or decreasing
the number of repetions may help in getting more stable results.</li>
</ul>
</div><footer class="article__footer"><!-- this will show at every article content's bottom --></footer>

  <div class="d-print-none"></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();</script></div><section class="page__comments d-print-none"></section></article>
              </div>
            </div></div></div><div class="page__footer d-print-none">
<div class="footer js-page-footer">
  <div class="main"><aside  itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Paulo Moura"><meta itemprop="url" content="/"><meta itemprop="description" content="Logtalk author and developer."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><li title="Contact us.">
      <a class="button button--circle mail-button" itemprop="email" href="mailto:support@logtalk.org" target="_blank">
        <i class="fas fa-envelope"></i>
      </a><li title="Follow us on Twitter.">
        <a class="button button--circle twitter-button" itemprop="sameAs" href="https://twitter.com/LogtalkDotOrg" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M1024.032 194.432c-37.664 16.704-78.176 28-120.672 33.088 43.36-26.016 76.672-67.168 92.384-116.224-40.608 24.064-85.568 41.568-133.408 50.976-38.336-40.832-92.928-66.336-153.344-66.336-116.032 0-210.08 94.048-210.08 210.08 0 16.48 1.856 32.512 5.44 47.872-174.592-8.768-329.408-92.416-433.024-219.52-18.08 31.04-28.448 67.104-28.448 105.632 0 72.896 37.088 137.184 93.472 174.88-34.432-1.088-66.816-10.528-95.168-26.272-0.032 0.864-0.032 1.76-0.032 2.656 0 101.792 72.416 186.688 168.512 205.984-17.632 4.8-36.192 7.36-55.36 7.36-13.536 0-26.688-1.312-39.52-3.776 26.72 83.456 104.32 144.192 196.256 145.888-71.904 56.352-162.496 89.92-260.928 89.92-16.96 0-33.664-0.992-50.112-2.944 92.96 59.616 203.392 94.4 322.048 94.4 386.432 0 597.728-320.128 597.728-597.76 0-9.12-0.192-18.176-0.608-27.168 41.056-29.632 76.672-66.624 104.832-108.736z" />
</svg>
</div>
        </a>
      </li><li title="Follow us on Github.">
        <a class="button button--circle github-button1" itemprop="sameAs" href="https://github.com/LogtalkDotOrg/logtalk3" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path class="svgpath" data-index="path_0" fill="#272636" d="M0 525.2c0 223.6 143.3 413.7 343 483.5 26.9 6.8 22.8-12.4 22.8-25.4l0-88.7c-155.3 18.2-161.5-84.6-172-101.7-21.1-36-70.8-45.2-56-62.3 35.4-18.2 71.4 4.6 113.1 66.3 30.2 44.7 89.1 37.2 119 29.7 6.5-26.9 20.5-50.9 39.7-69.6C248.8 728.2 181.7 630 181.7 513.2c0-56.6 18.7-108.7 55.3-150.7-23.3-69.3 2.2-128.5 5.6-137.3 66.5-6 135.5 47.6 140.9 51.8 37.8-10.2 80.9-15.6 129.1-15.6 48.5 0 91.8 5.6 129.8 15.9 12.9-9.8 77-55.8 138.8-50.2 3.3 8.8 28.2 66.7 6.3 135 37.1 42.1 56 94.6 56 151.4 0 117-67.5 215.3-228.8 243.7 26.9 26.6 43.6 63.4 43.6 104.2l0 128.8c0.9 10.3 0 20.5 17.2 20.5C878.1 942.4 1024 750.9 1024 525.3c0-282.9-229.3-512-512-512C229.1 13.2 0 242.3 0 525.2L0 525.2z" />
</svg>
</div>
        </a>
      </li><li title="Follow us on Linkedin.">
        <a class="button button--circle linkedin-button" itemprop="sameAs" href="https://www.linkedin.com/in/pjlmoura" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M260.096 155.648c0 27.307008-9.899008 50.516992-29.696 69.632-19.796992 19.115008-45.396992 28.672-76.8 28.672-30.036992 0-54.612992-9.556992-73.728-28.672-19.115008-19.115008-28.672-42.324992-28.672-69.632 0-28.672 9.556992-52.224 28.672-70.656 19.115008-18.432 44.372992-27.648 75.776-27.648 31.403008 0 56.32 9.216 74.752 27.648 18.432 18.432 28.331008 41.984 29.696 70.656 0 0 0 0 0 0m-202.752 808.96c0 0 0-632.832 0-632.832 0 0 196.608 0 196.608 0 0 0 0 632.832 0 632.832 0 0-196.608 0-196.608 0 0 0 0 0 0 0m313.344-430.08c0-58.708992-1.364992-126.292992-4.096-202.752 0 0 169.984 0 169.984 0 0 0 10.24 88.064 10.24 88.064 0 0 4.096 0 4.096 0 40.96-68.267008 105.812992-102.4 194.56-102.4 68.267008 0 123.220992 22.868992 164.864 68.608 41.643008 45.739008 62.464 113.664 62.464 203.776 0 0 0 374.784 0 374.784 0 0-196.608 0-196.608 0 0 0 0-350.208 0-350.208 0-91.476992-33.451008-137.216-100.352-137.216-47.787008 0-81.236992 24.576-100.352 73.728-4.096 8.192-6.144 24.576-6.144 49.152 0 0 0 364.544 0 364.544 0 0-198.656 0-198.656 0 0 0 0-430.08 0-430.08 0 0 0 0 0 0" />
</svg></div>
        </a>
      </li><li title="Chat with us.">
        <a class="button button--circle gitter-button" itemprop="sameAs" href="https://gitter.im/LogtalkDotOrg/logtalk3" target="_blank">
          <div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"/></svg>
<!--
Font Awesome Free 5.4.1 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
--></div>
        </a>
      </li></ul>
</div>
</div>
    </aside>
    <footer class="site-info"><p class="menu menu--center">
        <span>© Paulo Moura 2018-2024</span>
<!--
        <a type="application/rss+xml" href="/feed.xml">RSS</a>
-->
      </p>
      <p>Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> & <a
        title="TeXt is a succinct theme for blogging." href="https://github.com/kitian616/jekyll-TeXt-theme">TeXt Theme</a>.
      </p>
    </footer>
  </div>
</div></div></div>
    </div><div class="page__search-panel d-print-none""><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--secondary button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>

<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var searchData = window.TEXT_SEARCH_DATA ? initData(window.TEXT_SEARCH_DATA) : {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  function initData(data) {
    var _data = [], i, j, key, keys, cur;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i], _data[key] = [];
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        cur.title = window.decodeUrl(cur.title);
        cur.url = window.decodeUrl(cur.url);
        _data[key].push(cur);
      }
    }
    return _data;
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) {
      return null;
    }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $searchBox = $('.js-search-box');
  var $searchInput = $searchBox.children('input');
  var $searchClear = $searchBox.children('.js-icon-clear');
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function searchBoxEmpty() {
    $searchBox.removeClass('not-empty'); $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }

  $searchInput.on('input', window.throttle(function() {
    var val = $(this).val();
    if (val === '' || typeof val !== 'string') {
      searchBoxEmpty();
    } else {
      $searchBox.addClass('not-empty'); $result.html(render(searchByQuery(val)));
      $resultItems = $('.search-result__item'); activeIndex = 0;
      $resultItems.eq(0).addClass('active');
    }
  }, 400));
  $searchInput.on('focus', function() {
    $(this).addClass('focus');
  });
  $searchInput.on('blur', function() {
    $(this).removeClass('focus');
  });
  $searchClear.on('click', function() {
    $searchInput.val(''); searchBoxEmpty();
  });

  // search panel
  var $pageRoot = $('.js-page-root');
  var $pageMain = $('.js-page-main');
  var $searchToggle = $('.js-search-toggle');
  var showSearch = false;
  var scrollTop;

  function openSearchPanel() {
    scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
    $pageRoot.addClass('show-search-panel');
    $pageMain.scrollTop(scrollTop);
    $searchInput[0].focus();
  }

  function closeSearchPanel() {
    $pageRoot.removeClass('show-search-panel');
    $(window).scrollTop(scrollTop);
    $searchInput[0].blur();
    setTimeout(function() {
      $searchInput.val(''); searchBoxEmpty();
      window.pageAsideAffix && window.pageAsideAffix.refresh();
    }, 400);
  }

  // Char Code: 13  Enter, 27  ESC, 37  ⬅, 38  ⬆, 39  ➡, 40  ⬇, 83  S, 191 /
  function isFormElement(e) {
    var tagName = e.target.tagName || e.srcElement.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  }
  function charCodeFilter(e) {
    return e.target === $searchInput[0] && (e.which === 13 || e.which === 27 || e.which === 38 || e.which === 40);
  }

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  $(document).on('keyup', function(e) {
    if (!isFormElement(e) || charCodeFilter(e)) {
      if (e.which === 83 || e.which === 191) {
        showSearch || (showSearch = true, openSearchPanel());
      } else if (e.which ===  27) {
        showSearch && (showSearch = false, closeSearchPanel());
      } else if (e.which === 38) {
        showSearch && moveActiveIndex('up');
      } else if (e.which === 40) {
        showSearch && moveActiveIndex('down');
      } else if (e.which === 13) {
        showSearch && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });

  $searchToggle.on('click', function() {
    showSearch = !showSearch;
    showSearch ? openSearchPanel() : closeSearchPanel();
  });
});</script></div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();/*(function () {

})();*/</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();</script>
    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();</script>
  </body>
</html>