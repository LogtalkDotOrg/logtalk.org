<!DOCTYPE html><html lang="en">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>Coding Style Guidelines - Logtalk</title>

<meta name="description" content="Logtalk - Declarative object-oriented logic programming language
">
<link rel="canonical" href="http://localhost:4000/coding_style_guidelines.html"><link rel="alternate" type="application/rss+xml" title="Logtalk" href="/feed.xml">
<!-- begin favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#355b95">
<meta name="theme-color" content="#ffffff">
<!-- end favicon --><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" >
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.decodeUrl = function(str) {
    return str ? decodeURIComponent(str.replace(/\+/g, '%20')) : '';
  };


  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i, cb; loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cb = cbs[i]; cb();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.3',
      sources: {
        font_awesome: 'https://use.fontawesome.com/releases/v5.0.13/css/all.css',
        jquery: 'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js',
        leancloud_js_sdk: '//cdn1.lncld.net/static/js/3.4.1/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script></head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main page__viewport has-aside cell cell--auto">

      <div class="page__main-inner">
        <div></div><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand">
          <strong>[ ‚ä® ]&nbsp;</strong><a title="Logtalk - Declarative object-oriented logic programming language
" href="/">Logtalk</a></div>
<!--
        <button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button>
-->
      </div><nav class="navigation">
        <ul><li class="navigation__link"><a href="/rationale.html">Rationale</a></li><li class="navigation__link"><a href="/features.html">Features</a></li><li class="navigation__link"><a href="/documentation.html">Documentation</a></li><li class="navigation__link"><a href="/download.html">Download</a></li><li class="navigation__link"><a href="/tools.html">Tools</a></li><li class="navigation__link"><a href="/guides.html">Guides</a></li><li class="navigation__link"><a href="/support.html">Support</a></li><li class="navigation__link"><a href="/related.html">Related</a></li><li class="navigation__link"><a href="/news.html">News</a></li><li class="navigation__link"><a href="/blog.html">Blog</a></li><li class="navigation__link"><a href="/search.html"><i class="fa fa-search" aria-hidden="true"></i></a></li><!--
          <li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li>
-->
        </ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div></aside></div>

              <div class="col-main cell cell--auto"><article itemscope itemtype="http://schema.org/Article"><div class="article__header"><header><h1>Coding Style Guidelines</h1></header></div><meta itemprop="headline" content="Coding Style Guidelines"><meta itemprop="author" content="Paulo Moura"/><div class="js-article-content"><div class="layout--article">

  <div class="article__content" itemprop="articleBody"><p>In general, Prolog coding style guidelines also apply to Logtalk programming. Guidelines, including this one, should be taken as recommendation rather than dogma. Strict use of the guidelines here presented is only expected when contributing to the Logtalk distribution. When adapting this or other guidelines, the golden rule is consistency and consensus within your development team.</p>

<h2 id="organizing-your-source-files">Organizing your source files</h2>

<p>Store your files in a directory with a simple but descriptive name. Avoid using a name already in use in the current Logtalk distribution. Besides your source files, the directory often contains utility and documentation files such as:</p>

<ul>
  <li>
    <p>A loader file for your source files. Usually named <code class="highlighter-rouge">loader.lgt</code>, this file should load both your source files and any other files (e.g. library files) needed for compiling and running your code. Loader files may also be used to set appropriated flags for compiling and loading your source files. You may also want to have e.g. a <code class="highlighter-rouge">loader_debug.lgt</code> file if there‚Äôs a non-trivial debugging setup for developing your code.</p>
  </li>
  <li>
    <p>An informative <code class="highlighter-rouge">NOTES.md</code> or <code class="highlighter-rouge">NOTES.txt</code> file with a description of your code, authorship, copyright, and licensing information.</p>
  </li>
  <li>
    <p>A <code class="highlighter-rouge">SCRIPT.txt</code> file containing instructions on how to load your source files and sample queries.</p>
  </li>
  <li>
    <p>A loader file for your tests (which also loads your source files), usually named <code class="highlighter-rouge">tester.lgt</code> (this is the name expected by the testing automation script), side-by-side with ‚Äãthe <code class="highlighter-rouge">loader.lgt</code> file (so that the user can run your code tests simply by replacing <code class="highlighter-rouge">loader</code> by <code class="highlighter-rouge">tester</code> in the <code class="highlighter-rouge">logtalk_load/1</code> goal that loads your code).</p>
  </li>
  <li>
    <p>A file contain your unit tests, usually named <code class="highlighter-rouge">tests.lgt</code>. If there‚Äôs a single tests file, keep it in the same directory as the ‚Äã<code class="highlighter-rouge">loader.lgt</code> and <code class="highlighter-rouge">tester.lgt</code>‚Äã files. If there are multiple test files, use a <code class="highlighter-rouge">tests</code> or <code class="highlighter-rouge">test_files</code> sub-directory.</p>
  </li>
  <li>
    <p>A <em>doclet</em> file for generating documentation and diagrams for your source code, usually named <code class="highlighter-rouge">doclet.lgt</code> (this is the name expected by the doclet automation script).</p>
  </li>
</ul>

<p>If you are using a version control system, the <a href="https://github.com/LogtalkDotOrg/logtalk3/tree/master/coding">coding</a> directory contains <em>ignore files</em> for several systems.</p>

<h2 id="source-file-names">Source file names</h2>

<p>Logtalk source files use by default the <code class="highlighter-rouge">.lgt</code> file name extension. You can also use in alternative the <code class="highlighter-rouge">.logtalk</code> extension. When a source file contains a single entity, use the entity name for the source file name. For parametric objects and parametric categories, append the number of parameters to the file name. For source files containing multiple entities, use a descriptive name. In this case, the name is often the same as the name of the directory holding your files.</p>

<h2 id="source-file-text-encoding">Source file text encoding</h2>

<p>Use preferably US-ASCII or a Unicode encoding such as UTF-8. Avoid ISO-Latin-X text encodings unless that‚Äôs required by limitations on the backend Prolog compiler or client requirements. Ensure that any used text editor can correctly handle the chosen encoding.</p>

<h2 id="source-code-layout-and-indentation">Source code layout and indentation</h2>

<p>Indent your source file using tabs, not spaces. Never mix tabs and spaces for indentation. But do use spaces for alignment that is not related to indenting. One tab is one level of indentation and is <strong>independent</strong> of each team member preferred setting, contributing to <strong>accessibility</strong>. A common setting is a tab width equivalent to four spaces. <strong>Check that when changing the tab width that your code and comments remain perfectly indented</strong>. Use one tab for indenting the code encapsulated inside an entity. Indent the body of predicate clauses using one tab.</p>

<p>Clauses for the same predicate should be separated by at most one blank line. Closely related predicates (e.g. a predicate followed by its auxiliary predicates) should be separated by one or two blank lines. Clauses of other predicates can be separated by two or three blank lines, depending on code complexity.</p>

<h2 id="directives-layout">Directives layout</h2>

<p>The recommended layout for <code class="highlighter-rouge">initialization /1</code> directives is:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">:- initialization</span><span class="p">((</span>
    goal1<span class="p">,</span>
    goal2<span class="p">,</span>
    <span class="p">...</span>
<span class="p">)).</span>
</code></pre></div></div>

<p>A single tab/level of indentation is used for the directive arguments. The closing parentheses are aligned with the directive operator so that the alignment is preserved no matter the personal choice for the tab setting. Similar for other directives. For example:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">:- info</span><span class="p">([</span>
    version <span class="k">is</span> <span class="m">1.1</span><span class="p">,</span>
    author <span class="k">is</span> <span class="s">'John Doe'</span><span class="p">,</span>
    date <span class="k">is</span> <span class="m">2016</span><span class="o">/</span><span class="m">11</span><span class="o">/</span><span class="m">21</span><span class="p">,</span>
    comment <span class="k">is</span> <span class="s">'Lorem ipsum dolor sit amet, consectetur adipiscing elit.'</span>
<span class="p">]).</span>
<span class="k">
:- uses</span><span class="p">(</span>list<span class="p">,</span> <span class="p">[</span>
    append<span class="o">/</span><span class="m">3</span><span class="p">,</span> member<span class="o">/</span><span class="m">2</span><span class="p">,</span> select<span class="o">/</span><span class="m">3</span>
<span class="p">]).</span>
</code></pre></div></div>

<h2 id="comments">Comments</h2>

<p>General comments on entities and predicates can often be moved to entity <code class="highlighter-rouge">info/1</code> and predicate <code class="highlighter-rouge">info/2</code> directives. The documenting tool can then be used to extract, format, and publish that information. Outside these directives, use code comments for information that is not obvious from predicate names and variable names. Write ‚Äúinline‚Äù comments in a new line instead of in the same line after the code. For example:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...,</span>
goal1<span class="p">,</span>
<span class="c1">% comment about the previous goal or about the next goal
</span>goal2<span class="p">,</span>
<span class="c1">% ...
</span><span class="p">....</span>
</code></pre></div></div>

<p>This helps avoiding long lines, keeps the comments aligned with the code, and allows breaking long clauses into sections.</p>

<h2 id="clause-heads">Clause heads</h2>

<p>Long clause heads are sometimes unavoidable. For readability and independence of the personal choice for tab width, write:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>predicate_name<span class="p">(</span>
    first_argument<span class="p">,</span> second_argument<span class="p">,</span> <span class="p">...,</span>
    n_argument<span class="p">,</span> <span class="p">...</span>
<span class="p">)</span> <span class="o">:-</span>
    <span class="p">...</span>
</code></pre></div></div>

<p>Trying to align the arguments with the opening parenthesis would make the alignment break under different tab widths or even worse could result in a mix of tabs and spaces for indentation.</p>

<h2 id="goals-in-clause-bodies">Goals in clause bodies</h2>

<p>As a general rule, write one goal per line. Exceptions are green cuts and goals like <code class="highlighter-rouge">nl</code> after a write term goal. In this case, write the two goals in the same line. Red cuts should always be written in a separate line.</p>

<p>Complex goals can be more readable, however, using several lines. For example:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...,</span>
<span class="k">setof</span><span class="p">(</span>
    <span class="nv">Template</span><span class="p">,</span>
    <span class="p">(</span>   <span class="k">current_predicate</span><span class="p">(</span><span class="nv">Functor</span><span class="o">/</span><span class="nv">Arity</span><span class="p">),</span>
        <span class="k">functor</span><span class="p">(</span><span class="nv">Template</span><span class="p">,</span> <span class="nv">Functor</span><span class="p">,</span> <span class="nv">Arity</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="nv">Templates</span>
<span class="p">),</span>
<span class="p">...</span>
</code></pre></div></div>

<p>Note the parenthesis alignment.</p>

<h2 id="meta-arguments">Meta-arguments</h2>

<p>Goal arguments in meta-predicates calls (e.g. <code class="highlighter-rouge">findall/3</code>) should be simple. Ideally, a single predicate call. Complex meta-arguments are hard to read, debug, and, depending on the backend Prolog compiler, may result in poor performance. In some cases, a lambda expression can be used to avoid adding an auxiliary predicate just for the meta-call.</p>

<h2 id="disjunctions">Disjunctions</h2>

<p>Disjunctions should always be wrapped between parenthesis and the <code class="highlighter-rouge">;</code> operator should be the first term in the line. For example:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="p">(</span>   alternative1
<span class="o">;</span>   alternative2
<span class="o">;</span>   <span class="p">...</span>
<span class="p">),</span>
<span class="p">...</span>
</code></pre></div></div>

<p>When the disjunction is the sole goal in a clause body, use instead separate clauses. For example, instead of:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>head <span class="o">:-</span>
    <span class="p">(</span>   alternative1
    <span class="o">;</span>   alternative2
    <span class="p">).</span>
</code></pre></div></div>

<p>write instead:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>head <span class="o">:-</span>
    alternative1<span class="p">.</span>
head <span class="o">:-</span>
    alternative2<span class="p">.</span>
</code></pre></div></div>

<p>One exception to this guideline is when the head of the clause performs costly access to a sub-term in complex compound argument.</p>

<h2 id="if-then-else-constructs">If-then-else constructs</h2>

<p>Always use parenthesis around if-then-else constructs and always include the ‚Äúelse‚Äù part. I.e. write if necessary <code class="highlighter-rouge">(If -&gt; Then; fail)</code> instead of <code class="highlighter-rouge">(If -&gt; Then)</code>. An actual example of the recommended layout:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>is_prime<span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">Sqrt</span><span class="p">,</span> <span class="nv">Prime</span><span class="p">)</span> <span class="o">:-</span>
    <span class="p">(</span>   <span class="nv">N</span> <span class="o">&gt;</span> <span class="nv">Sqrt</span> <span class="o">-&gt;</span>
        <span class="k">true</span>
    <span class="o">;</span>   <span class="nv">Prime</span> <span class="o">mod</span> <span class="nv">N</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span>
        <span class="nv">N2</span> <span class="k">is</span> <span class="nv">N</span> <span class="o">+</span> <span class="m">2</span><span class="p">,</span>
        is_prime<span class="p">(</span><span class="nv">N2</span><span class="p">,</span> <span class="nv">Sqrt</span><span class="p">,</span> <span class="nv">Prime</span><span class="p">)</span>
    <span class="p">).</span>
</code></pre></div></div>

<p>Use a tab between the opening parenthesis and the first goal. Also use a tab between the <code class="highlighter-rouge">;</code> and the goal that follows. Align vertically the opening parenthesis, the <code class="highlighter-rouge">;</code>, and the closing parenthesis. A common variant is to write:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>is_prime<span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">Sqrt</span><span class="p">,</span> <span class="nv">Prime</span><span class="p">)</span> <span class="o">:-</span>
    <span class="p">(</span>   <span class="nv">N</span> <span class="o">&gt;</span> <span class="nv">Sqrt</span>
    <span class="o">-&gt;</span>  <span class="k">true</span>
    <span class="o">;</span>   <span class="nv">Prime</span> <span class="o">mod</span> <span class="nv">N</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span>
        <span class="nv">N2</span> <span class="k">is</span> <span class="nv">N</span> <span class="o">+</span> <span class="m">2</span><span class="p">,</span>
        is_prime<span class="p">(</span><span class="nv">N2</span><span class="p">,</span> <span class="nv">Sqrt</span><span class="p">,</span> <span class="nv">Prime</span><span class="p">)</span>
    <span class="p">).</span>
</code></pre></div></div>

<p>Choose a variant and use it consistently.</p>

<h2 id="failure-driven-loops">Failure-driven loops</h2>

<p>Indent with one tab the goals between the generator goal and the goal that forces backtracking. For example:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>write_person_database <span class="o">:-</span>
    person<span class="p">(</span><span class="nv">Name</span><span class="p">,</span> <span class="nv">Age</span><span class="p">),</span>
        <span class="k">write</span><span class="p">(</span><span class="s">'Name: '</span><span class="p">),</span> <span class="k">write</span><span class="p">(</span><span class="nv">Name</span><span class="p">),</span> <span class="k">nl</span><span class="p">,</span>
        <span class="k">write</span><span class="p">(</span><span class="s">'Age: '</span><span class="p">),</span> <span class="k">write</span><span class="p">(</span><span class="nv">Age</span><span class="p">),</span> <span class="k">nl</span><span class="p">,</span> <span class="k">nl</span><span class="p">,</span>
    <span class="k">fail</span><span class="p">.</span>
write_person_database<span class="p">.</span>
</code></pre></div></div>

<p>In cases where a failure-driven loop can mask unexpected failures, consider using in alternative the <code class="highlighter-rouge">forall/2</code> meta-predicate.</p>

<h2 id="predicate-arguments">Predicate arguments</h2>

<p>Use a single space after commas that separate predicate arguments to improve readability.</p>

<h2 id="operators">Operators</h2>

<p>As a general rule, use spaces around binary operators. E.g. write <code class="highlighter-rouge">Total is Sum * N - OverHead</code>, not <code class="highlighter-rouge">Total is Sum*N-OverHead</code>.</p>

<h2 id="list-elements">List elements</h2>

<p>Use a single space after commas that separate elements. Also use a single space after the <code class="highlighter-rouge">|</code> separating the enumerated elements from the list with the remaining elements. I.e. write <code class="highlighter-rouge">[First, Second| Rest]</code>, not <code class="highlighter-rouge">[First,Second|Rest]</code>.</p>

<h2 id="clause-rules-and-directives">Clause rules and directives</h2>

<p>Use a single space before the <code class="highlighter-rouge">:-</code> operator in clause rules. Use a single space after the <code class="highlighter-rouge">:-</code> operator in directives.</p>

<h2 id="entity-names">Entity names</h2>

<p>For object, protocol, and category names, observe the same guidelines as for predicate names.</p>

<h2 id="predicate-names">Predicate names</h2>

<p>Use descriptive predicate names using underscores if necessary to link words. Do not use CamelCase notation for predicate names (e.g. write <code class="highlighter-rouge">number_of_sides</code>, not <code class="highlighter-rouge">numberOfSides</code>). Avoid word abbreviations. But if you abbreviate a word, do so consistently. Also avoid names with digits in the middle as this may hurt readability.</p>

<p>For dynamic predicates, Logtalk uses a convention of ending its names with an underscore (e.g. <code class="highlighter-rouge">random_seed_</code>) although this style is sometimes also used for auxiliary predicate names.</p>

<p>For public predicates, when defining an interface, always consider reusing names. This makes APIs easier to understand and use. For example, the predicate <code class="highlighter-rouge">member/2</code> is used with both lists and sets. The predicate <code class="highlighter-rouge">size/2</code> is used with both dictionaries and heaps. Most developer tools that require processing files, directories, and libraries share a common interface.</p>

<h2 id="variable-names">Variable names</h2>

<p>Use descriptive variable names in CamelCase notation (e.g. write <code class="highlighter-rouge">SourceFile</code>, not <code class="highlighter-rouge">Source_file</code>). Again, avoid word abbreviations. But if you do abbreviate words, be consistent. Also avoid names with digits in the middle as this may hurt readability.</p>

<p>In the case of singleton variables, use either the anonymous variable, <code class="highlighter-rouge">_</code>, or a variable name starting with an underscore followed with an uppercase letter (e.g. <code class="highlighter-rouge">_Width</code>). Note that the interpretation of variables that start with an underscore as either singleton variables or anonymous variables depends on the used back-end compiler (see the Logtalk compiler flag <code class="highlighter-rouge">underscore_variables</code> for more information).</p>

<h2 id="sequences">Sequences</h2>

<p>Arguments that represent a sequence of <em>states</em>, e.g. successive values of an accumulator, should be represented using variables named <code class="highlighter-rouge">S0</code>, <code class="highlighter-rouge">S1</code>, ‚Ä¶, <code class="highlighter-rouge">S</code>, with <code class="highlighter-rouge">S</code> replaced by an adequate argument name. For example:</p>

<div class="language-logtalk highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sum_list<span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="nv">Sum</span><span class="p">)</span> <span class="o">:-</span>
    sum_list<span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="nv">Sum</span><span class="p">).</span>

sum_list<span class="p">([],</span> <span class="nv">Sum</span><span class="p">,</span> <span class="nv">Sum</span><span class="p">).</span>
sum_list<span class="p">([</span><span class="nv">Value</span><span class="p">|</span> <span class="nv">Values</span><span class="p">],</span> <span class="nv">Sum0</span><span class="p">,</span> <span class="nv">Sum</span><span class="p">)</span> <span class="o">:-</span>
    <span class="nv">Sum1</span> <span class="k">is</span> <span class="nv">Sum0</span> <span class="o">+</span> <span class="nv">Value</span><span class="p">,</span>
    sum_list<span class="p">(</span><span class="nv">Values</span><span class="p">,</span> <span class="nv">Sum1</span><span class="p">,</span> <span class="nv">Sum</span><span class="p">).</span>
</code></pre></div></div>

<h2 id="top-level-interpreter-shortcuts">Top-level interpreter shortcuts</h2>

<p>Logtalk (and Prolog) define top-level interpreter shortcuts for loading source files and for <code class="highlighter-rouge">make</code> tasks. These shortcuts are <strong>not</strong> part of the language and should only be used at the top-level interpreter and never in source files.</p>

<h2 id="entity-and-predicate-documentation">Entity and predicate documentation</h2>

<p>The <a href="https://logtalk.org/manuals/index.html">Logtalk Handbook</a> includes a section on <a href="https://logtalk.org/manuals/userman/documenting.html">documenting</a> applications. See also the Handbook section on <a href="https://logtalk.org/manuals/userman/predicates.html#declaring-predicates">declaring predicates</a>, notably the sub-section on the <a href="https://logtalk.org/manuals/userman/predicates.html#mode-directive"><code class="highlighter-rouge">mode/2</code></a> directive.</p>
</div><footer class="article__footer"><!-- this will show at every article content's bottom --></footer>

  <div class="d-print-none"></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();</script></div><section class="page__comments d-print-none"></section></article>
              </div>
            </div></div></div><div class="page__footer d-print-none">
<div class="footer js-page-footer">
  <div class="main"><aside  itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Paulo Moura"><meta itemprop="url" content="/"><meta itemprop="description" content="Logtalk author and developer."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><li title="Contact us.">
      <a class="button button--circle mail-button" itemprop="email" href="mailto:support@logtalk.org" target="_blank">
        <i class="fas fa-envelope"></i>
      </a><li title="Follow us on Twitter.">
        <a class="button button--circle twitter-button" itemprop="sameAs" href="https://twitter.com/LogtalkDotOrg" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M1024.032 194.432c-37.664 16.704-78.176 28-120.672 33.088 43.36-26.016 76.672-67.168 92.384-116.224-40.608 24.064-85.568 41.568-133.408 50.976-38.336-40.832-92.928-66.336-153.344-66.336-116.032 0-210.08 94.048-210.08 210.08 0 16.48 1.856 32.512 5.44 47.872-174.592-8.768-329.408-92.416-433.024-219.52-18.08 31.04-28.448 67.104-28.448 105.632 0 72.896 37.088 137.184 93.472 174.88-34.432-1.088-66.816-10.528-95.168-26.272-0.032 0.864-0.032 1.76-0.032 2.656 0 101.792 72.416 186.688 168.512 205.984-17.632 4.8-36.192 7.36-55.36 7.36-13.536 0-26.688-1.312-39.52-3.776 26.72 83.456 104.32 144.192 196.256 145.888-71.904 56.352-162.496 89.92-260.928 89.92-16.96 0-33.664-0.992-50.112-2.944 92.96 59.616 203.392 94.4 322.048 94.4 386.432 0 597.728-320.128 597.728-597.76 0-9.12-0.192-18.176-0.608-27.168 41.056-29.632 76.672-66.624 104.832-108.736z" />
</svg>
</div>
        </a>
      </li><li title="Follow us on Github.">
        <a class="button button--circle github-button1" itemprop="sameAs" href="https://github.com/LogtalkDotOrg/logtalk3" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path class="svgpath" data-index="path_0" fill="#272636" d="M0 525.2c0 223.6 143.3 413.7 343 483.5 26.9 6.8 22.8-12.4 22.8-25.4l0-88.7c-155.3 18.2-161.5-84.6-172-101.7-21.1-36-70.8-45.2-56-62.3 35.4-18.2 71.4 4.6 113.1 66.3 30.2 44.7 89.1 37.2 119 29.7 6.5-26.9 20.5-50.9 39.7-69.6C248.8 728.2 181.7 630 181.7 513.2c0-56.6 18.7-108.7 55.3-150.7-23.3-69.3 2.2-128.5 5.6-137.3 66.5-6 135.5 47.6 140.9 51.8 37.8-10.2 80.9-15.6 129.1-15.6 48.5 0 91.8 5.6 129.8 15.9 12.9-9.8 77-55.8 138.8-50.2 3.3 8.8 28.2 66.7 6.3 135 37.1 42.1 56 94.6 56 151.4 0 117-67.5 215.3-228.8 243.7 26.9 26.6 43.6 63.4 43.6 104.2l0 128.8c0.9 10.3 0 20.5 17.2 20.5C878.1 942.4 1024 750.9 1024 525.3c0-282.9-229.3-512-512-512C229.1 13.2 0 242.3 0 525.2L0 525.2z" />
</svg>
</div>
        </a>
      </li><li title="Follow us on Linkedin.">
        <a class="button button--circle linkedin-button" itemprop="sameAs" href="https://www.linkedin.com/in/pjlmoura" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M260.096 155.648c0 27.307008-9.899008 50.516992-29.696 69.632-19.796992 19.115008-45.396992 28.672-76.8 28.672-30.036992 0-54.612992-9.556992-73.728-28.672-19.115008-19.115008-28.672-42.324992-28.672-69.632 0-28.672 9.556992-52.224 28.672-70.656 19.115008-18.432 44.372992-27.648 75.776-27.648 31.403008 0 56.32 9.216 74.752 27.648 18.432 18.432 28.331008 41.984 29.696 70.656 0 0 0 0 0 0m-202.752 808.96c0 0 0-632.832 0-632.832 0 0 196.608 0 196.608 0 0 0 0 632.832 0 632.832 0 0-196.608 0-196.608 0 0 0 0 0 0 0m313.344-430.08c0-58.708992-1.364992-126.292992-4.096-202.752 0 0 169.984 0 169.984 0 0 0 10.24 88.064 10.24 88.064 0 0 4.096 0 4.096 0 40.96-68.267008 105.812992-102.4 194.56-102.4 68.267008 0 123.220992 22.868992 164.864 68.608 41.643008 45.739008 62.464 113.664 62.464 203.776 0 0 0 374.784 0 374.784 0 0-196.608 0-196.608 0 0 0 0-350.208 0-350.208 0-91.476992-33.451008-137.216-100.352-137.216-47.787008 0-81.236992 24.576-100.352 73.728-4.096 8.192-6.144 24.576-6.144 49.152 0 0 0 364.544 0 364.544 0 0-198.656 0-198.656 0 0 0 0-430.08 0-430.08 0 0 0 0 0 0" />
</svg></div>
        </a>
      </li><li title="Chat with us.">
        <a class="button button--circle gitter-button" itemprop="sameAs" href="https://gitter.im/LogtalkDotOrg/logtalk3" target="_blank">
          <div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"/></svg>
<!--
Font Awesome Free 5.4.1 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
--></div>
        </a>
      </li></ul>
</div>
</div>
    </aside>
    <footer class="site-info"><p class="menu menu--center">
        <span>¬© Paulo Moura 2018-2024</span>
<!--
        <a type="application/rss+xml" href="/feed.xml">RSS</a>
-->
      </p>
      <p>Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> & <a
        title="TeXt is a succinct theme for blogging." href="https://github.com/kitian616/jekyll-TeXt-theme">TeXt Theme</a>.
      </p>
    </footer>
  </div>
</div></div></div>
    </div><div class="page__search-panel d-print-none""><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--secondary button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>

<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var searchData = window.TEXT_SEARCH_DATA ? initData(window.TEXT_SEARCH_DATA) : {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  function initData(data) {
    var _data = [], i, j, key, keys, cur;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i], _data[key] = [];
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        cur.title = window.decodeUrl(cur.title);
        cur.url = window.decodeUrl(cur.url);
        _data[key].push(cur);
      }
    }
    return _data;
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) {
      return null;
    }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $searchBox = $('.js-search-box');
  var $searchInput = $searchBox.children('input');
  var $searchClear = $searchBox.children('.js-icon-clear');
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function searchBoxEmpty() {
    $searchBox.removeClass('not-empty'); $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }

  $searchInput.on('input', window.throttle(function() {
    var val = $(this).val();
    if (val === '' || typeof val !== 'string') {
      searchBoxEmpty();
    } else {
      $searchBox.addClass('not-empty'); $result.html(render(searchByQuery(val)));
      $resultItems = $('.search-result__item'); activeIndex = 0;
      $resultItems.eq(0).addClass('active');
    }
  }, 400));
  $searchInput.on('focus', function() {
    $(this).addClass('focus');
  });
  $searchInput.on('blur', function() {
    $(this).removeClass('focus');
  });
  $searchClear.on('click', function() {
    $searchInput.val(''); searchBoxEmpty();
  });

  // search panel
  var $pageRoot = $('.js-page-root');
  var $pageMain = $('.js-page-main');
  var $searchToggle = $('.js-search-toggle');
  var showSearch = false;
  var scrollTop;

  function openSearchPanel() {
    scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
    $pageRoot.addClass('show-search-panel');
    $pageMain.scrollTop(scrollTop);
    $searchInput[0].focus();
  }

  function closeSearchPanel() {
    $pageRoot.removeClass('show-search-panel');
    $(window).scrollTop(scrollTop);
    $searchInput[0].blur();
    setTimeout(function() {
      $searchInput.val(''); searchBoxEmpty();
      window.pageAsideAffix && window.pageAsideAffix.refresh();
    }, 400);
  }

  // Char Code: 13  Enter, 27  ESC, 37  ‚¨Ö, 38  ‚¨Ü, 39  ‚û°, 40  ‚¨á, 83  S, 191 /
  function isFormElement(e) {
    var tagName = e.target.tagName || e.srcElement.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  }
  function charCodeFilter(e) {
    return e.target === $searchInput[0] && (e.which === 13 || e.which === 27 || e.which === 38 || e.which === 40);
  }

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  $(document).on('keyup', function(e) {
    if (!isFormElement(e) || charCodeFilter(e)) {
      if (e.which === 83 || e.which === 191) {
        showSearch || (showSearch = true, openSearchPanel());
      } else if (e.which ===  27) {
        showSearch && (showSearch = false, closeSearchPanel());
      } else if (e.which === 38) {
        showSearch && moveActiveIndex('up');
      } else if (e.which === 40) {
        showSearch && moveActiveIndex('down');
      } else if (e.which === 13) {
        showSearch && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });

  $searchToggle.on('click', function() {
    showSearch = !showSearch;
    showSearch ? openSearchPanel() : closeSearchPanel();
  });
});</script></div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();/*(function () {

})();*/</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();</script>
    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();</script>
  </body>
</html>